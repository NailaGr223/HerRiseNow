{% extends "base.html" %}
{% load static %}
{% block styles %}

  <style>
    :root {
      --primary: #d946ef;
      --secondary: #8b5cf6;
      --accent: #ec4899;
      --dark: #1a1a2e;
    }
    body {
      background: linear-gradient(135deg, #fce7f3, #f0d6ff);
      min-height: 100vh;
      font-family: 'Roboto', sans-serif;
    }
    .form-card {
      background: white;
      border-radius: 32px;
      box-shadow: 0 30px 80px rgba(0,0,0,0.18);
      max-width: 680px;
      margin: 3rem auto 6rem;
      overflow: hidden;
    }
    .form-header {
      background: linear-gradient(135deg, var(--accent), #f43f5e);
      color: white;
      padding: 4rem 2rem;
      text-align: center;
    }
    .text-gradient {
      background: linear-gradient(90deg, #fff, #fddfff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .form-body { padding: 3.5rem 3rem; }
    .btn-submit {
      background: linear-gradient(135deg, var(--accent), #f43f5e);
      border: none;
      padding: 1.1rem 3.5rem;
      font-size: 1.3rem;
      font-weight: 600;
      border-radius: 50px;
      transition: all 0.3s ease;
    }
    .btn-submit:hover {
      transform: translateY(-6px);
      box-shadow: 0 22px 50px rgba(244, 63, 94, 0.5);
    }
    .mentor-img {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--primary);
    }
    .highlight-box {
      background: #fff0f8;
      border-left: 5px solid var(--primary);
      padding: 1.2rem 1.5rem;
      border-radius: 0 16px 16px 0;
      font-size: 0.98rem;
    }
  </style>
{% endblock %}


{% block content %}
<section class="py-5" style="background: linear-gradient(135deg, #e0c3fc, #c8b5ff);">
  <div class="container py-5">
    <div class="text-center mb-5">
      <i class="bi bi-book-fill fs-1 text-primary mb-4"></i>
      <h1 class="display-4 fw-bold text-gradient" 
          style="background:linear-gradient(90deg,#8b5cf6,#d946ef);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">
        Learn & Grow With Us
      </h1>
      <p class="lead fs-3">Free and low-cost courses designed for women, by women</p>
    </div>

    <div class="row justify-content-center">
      <div class="col-lg-9">
        <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
          <div class="card-header text-white text-center py-5" 
               style="background: linear-gradient(135deg, #8b5cf6, #d946ef);">
            <h2 class="fw-bold mb-0">Register Your Interest</h2>
            <p class="lead opacity-90 mb-0 mt-2">Tell us what you want to learn — we’ll make it happen!</p>
          </div>

          <div class="card-body p-5">

            <form action="{% url 'learnform' %}" method="POST">
           {% csrf_token %}
           <input type="hidden" name="form_type" value="Learn & Grow Interest">
           <input type="hidden" name="_next" value="{% url 'learn' %}">
    
              <!-- Full Name -->
              <div class="mb-4">
                <label class="form-label fw-bold">Full Name *</label>
                <input type="text" name="entry.123456789" class="form-control form-control-lg" 
                       placeholder="e.g. Fatuma Ali" required>
              </div>

              <!-- Email -->
              <div class="mb-4">
                <label class="form-label fw-bold">Email Address *</label>
                <input type="email" name="entry.987654321" class="form-control form-control-lg" 
                       placeholder="fatuma@example.com" required>
              </div>

              <!-- Phone (WhatsApp preferred) -->
              <div class="mb-4">
                <label class="form-label fw-bold">Phone Number (WhatsApp preferred) *</label>
                <input type="tel" name="entry.112233445" class="form-control form-control-lg" 
                       placeholder="+254 712 345 678" required>
              </div>

              <!-- Current Education / Career Level -->
              <div class="mb-4">
                <label class="form-label fw-bold">Your Current Stage *</label>
                <select name="entry.556677889" class="form-select form-select-lg" required>
                  <option value="" disabled selected>Where are you right now?</option>
                  <option>High School Student</option>
                  <option>University / College Student</option>
                  <option>Recent Graduate</option>
                  <option>Early Career (0–3 years experience)</option>
                  <option>Mid-Career Professional</option>
                  <option>Entrepreneur / Business Owner</option>
                  <option>Returning to Work / Career Break</option>
                  <option>Other</option>
                </select>
              </div>

              <!-- Courses You're Interested In (Multiple Choice) -->
              <div class="mb-4">
                <label class="form-label fw-bold">What do you want to learn? (Select all that apply) *</label>
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Digital Skills (Computer, Internet, MS Office)">
                      <label class="form-check-label">Digital Skills (Computer, Internet, MS Office)</label>
                    </div>
                    <!-- <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Personal Finance & Money Management">
                      <label class="form-check-label">Personal Finance & Money Management</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Start Your Own Business">
                      <label class="form-check-label">Start Your Own Business</label>
                    </div> -->
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Public Speaking & Confidence">
                      <label class="form-check-label">Public Speaking & Confidence</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Leadership Skills">
                      <label class="form-check-label">Leadership Skills</label>
                    </div>
                    <!-- <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Graphic Design / Creative Skills">
                      <label class="form-check-label">Graphic Design / Creative Skills</label>
                    </div> -->
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="English Language / Communication">
                      <label class="form-check-label">English Language / Communication</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Other (write below)">
                      <label class="form-check-label">Other (write below)</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Other Topics (Open Text) -->
              <div class="mb-4">
                <label class="form-label fw-bold">Any other topics or skills you’d love to learn?</label>
                <textarea name="entry.443322110" class="form-control form-control-lg" rows="4"
                          placeholder="e.g. Coding, Photography, Mental Health First Aid, Tailoring, etc."></textarea>
              </div>

              <!-- Preferred Learning Format -->
              <div class="mb-4">
                <label class="form-label fw-bold">How do you prefer to learn? *</label>
                <select name="entry.667788990" class="form-select form-select-lg" required>
                  <option value="" disabled selected>Choose one</option>
                  <option>In-person workshops (Mombasa only(for now))</option>
                  <option>Online live classes (Zoom/ Meet)</option>
                  <option>Self-paced videos + WhatsApp group</option>
                  <option>Weekend intensives</option>
                  <option>Any format – just teach me!</option>
                </select>
              </div>

              <!-- Availability -->
              <div class="mb-5">
                <label class="form-label fw-bold">When are you free to learn?</label>
                <select name="entry.223344556" class="form-select form-select-lg">
                  <option>Mornings (9am–12noon)</option>
                  <option>Afternoons (2pm–5pm)</option>
                  <option>Evenings (6pm–9pm)</option>
                  <option>Weekends only</option>
                  <option>Very flexible</option>
                </select>
              </div>

              <!-- Submit Button -->
              <div class="text-center">
                <button type="submit" class="btn text-white fw-bold px-5 py-3 rounded-pill shadow-lg"
                        style="background: linear-gradient(135deg, #8b5cf6, #d946ef); font-size: 1.3rem;">
                  Register My Interest
                </button>
              </div>

              <p class="text-center text-muted mt-5 small">
                Most courses are <strong>100% free</strong> • Limited spots • You’ll hear back within 5 days
              </p>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
  <script>
  // Redirect to mentorship.html after Google Form submission
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    
    form.addEventListener("submit", function (e) {
      // Show thank you message
      e.preventDefault(); // Stop normal submission temporarily
      
      // Optional: Show a nice thank you overlay
      const thankYou = `
        <div style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);color:white;display:flex;align-items:center;justify-content:center;z-index:9999;flex-direction:column;padding:2rem;text-align:center;">
          <i class="bi bi-heart-fill fs-1 text-accent mb-3" style="color:#ec4899;"></i>
          <h1 class="display-5 fw-bold">Thank You, Sister!</h1>
          <p class="lead">Your application has been submitted.<br>We’ll match you with your peer circle soon.</p>
          <p>Redirecting you back to Learn ...</p>
        </div>
      `;
      document.body.insertAdjacentHTML('beforeend', thankYou);

      // Submit the form for real
      setTimeout(() => {
        form.submit();
      }, 800);

      // Redirect after 3 seconds (Google Forms finishes submitting)
      setTimeout(() => {
        window.location.href= "{% url 'learn' %}";
      }, 3000);
    });
  });
</script>
<script>
  // PERFECT redirect after Google Form submission
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");

    form.addEventListener("submit", function (e) {
      e.preventDefault(); // Stop normal submit

      // 1. Show beautiful thank you
      document.body.innerHTML = `
        <div style="min-height:100vh;background:linear-gradient(135deg,#fce7f3,#f0d6ff);display:flex;align-items:center;justify-content:center;flex-direction:column;gap:2rem;padding:2rem;text-align:center;">
          <i class="bi bi-heart-fill" style="font-size:4rem;color:#ec4899;"></i>
          <h1 class="display-4 fw-bold text-gradient" style="background:linear-gradient(90deg,#ec4899,#d946ef);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">
            Thank You, Sister!
          </h1>
          <p class="lead">Your application was submitted successfully.</p>
          <p>Redirecting you back to Learn in <span id="countdown">3</span> seconds...</p>
        </div>
      `;

      // 2. Submit the real form (in background)
      const formData = new FormData(form);
      fetch(form.action, {
        method: "POST",
        body: formData,
        mode: "no-cors"  // Important for Google Forms
      });

      // 3. Countdown + redirect
      let seconds = 3;
      const countdown = setInterval(() => {
        seconds--;
        document.getElementById("countdown").textContent = seconds;
        if (seconds <= 0) {
          clearInterval(countdown);
          window.location.href = "{% url 'learn' %}";  // This WILL work now
        }
      }, 1000);
    });
  });
</script>
{% endblock %}
</body>
</html>