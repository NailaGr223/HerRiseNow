{% extends "base.html" %}
{% load static %}
{% block styles %}

  <style>
    :root {
      --primary: #d946ef;
      --secondary: #8b5cf6;
      --accent: #ec4899;
      --dark: #1a1a2e;
    }
    body {
      background: linear-gradient(135deg, #fce7f3, #f0d6ff);
      min-height: 100vh;
      font-family: 'Roboto', sans-serif;
    }
    .form-card {
      background: white;
      border-radius: 32px;
      box-shadow: 0 30px 80px rgba(0,0,0,0.18);
      max-width: 680px;
      margin: 3rem auto 6rem;
      overflow: hidden;
    }
    .form-header {
      background: linear-gradient(135deg, var(--accent), #f43f5e);
      color: white;
      padding: 4rem 2rem;
      text-align: center;
    }
    .text-gradient {
      background: linear-gradient(90deg, #fff, #fddfff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .form-body { padding: 3.5rem 3rem; }
    .btn-submit {
      background: linear-gradient(135deg, var(--accent), #f43f5e);
      border: none;
      padding: 1.1rem 3.5rem;
      font-size: 1.3rem;
      font-weight: 600;
      border-radius: 50px;
      transition: all 0.3s ease;
    }
    .btn-submit:hover {
      transform: translateY(-6px);
      box-shadow: 0 22px 50px rgba(244, 63, 94, 0.5);
    }
    .mentor-img {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--primary);
    }
    .highlight-box {
      background: #fff0f8;
      border-left: 5px solid var(--primary);
      padding: 1.2rem 1.5rem;
      border-radius: 0 16px 16px 0;
      font-size: 0.98rem;
    }
  </style>
{% endblock %}  
{% block content %}
  <!-- COUNSELING INTAKE FORM – Paste inside <body> -->
<section class="py-5" style="background: linear-gradient(135deg, #f3e8ff, #e0d4ff);">
  <div class="container py-5">
    <div class="text-center mb-5">
      <i class="bi bi-heart-pulse-fill fs-1 text-primary mb-4"></i>
      <h1 class="display-4 fw-bold text-gradient" style="background:linear-gradient(90deg,#a855f7,#d946ef);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">
        Counseling & Emotional Support
      </h1>
      <p class="lead fs-3">You are safe here. We’re listening.</p>
    </div>

    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
          <div class="card-header text-white text-center py-5" style="background: linear-gradient(135deg, #a855f7, #d946ef);">
            <h2 class="fw-bold mb-0">Book a Confidential Session</h2>
            <p class="lead opacity-90 mb-0 mt-2">100% free • Female counselors only • No judgment</p>
          </div>

          <div class="card-body p-5">

            <form action="{% url 'counselingform' %}" method="POST">
              {% csrf_token %}
             <input type="hidden" name="form_type" value="Counseling Request">
             <input type="hidden" name="_next" value="{% url 'counseling' %}">
    
              
              <!-- Full Name -->
              <div class="mb-4">
                <label class="form-label fw-bold">Full Name *</label>
                <input type="text" name="entry.123456789" class="form-control form-control-lg" placeholder="e.g. Aisha Mohamed" required>
              </div>

              <!-- Email -->
              <div class="mb-4">
                <label class="form-label fw-bold">Email Address *</label>
                <input type="email" name="entry.987654321" class="form-control form-control-lg" placeholder="aisha@example.com" required>
              </div>

              <!-- Phone (WhatsApp preferred) -->
              <div class="mb-4">
                <label class="form-label fw-bold">Phone Number (WhatsApp preferred) *</label>
                <input type="tel" name="entry.112233445" class="form-control form-control-lg" placeholder="+254 712 345 678" required>
              </div>

              <!-- Choose Counselor -->
              <div class="mb-4">
                <label class="form-label fw-bold">Preferred Counselor *</label>
                <select name="entry.556677889" class="form-select form-select-lg">
                  <option value="">No preference – match me with the best fit</option>
                  <option>Ms.Nahya Ebrahim – B.A in Sociology</option>
                  <!-- <option>Dr. Grace Njeri – Clinical Psychologist</option>
                  <option>Sister Fatuma Ali – Youth & Faith-Based Support</option> -->
                </select>
              </div>

              <!-- Reason for Counseling -->
              <div class="mb-4">
                <label class="form-label fw-bold">What brings you here today? *</label>
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="GBV / Abuse">
                      <label class="form-check-label">GBV / Abuse</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Anxiety / Stress">
                      <label class="form-check-label">Anxiety / Stress</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Depression">
                      <label class="form-check-label">Depression</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Self-worth / Confidence">
                      <label class="form-check-label">Self-worth / Confidence</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Relationships">
                      <label class="form-check-label">Relationships / Family</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="entry.998877665" value="Other">
                      <label class="form-check-label">Other (explain below)</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- More Details -->
              <div class="mb-4">
                <label class="form-label fw-bold">Tell us more (optional but helpful)</label>
                <textarea name="entry.443322110" class="form-control form-control-lg" rows="5"
                          placeholder="Share as much or as little as you’re comfortable with... We’re here to listen."></textarea>
              </div>

              <!-- Preferred Contact Time -->
              <div class="mb-5">
                <label class="form-label fw-bold">Best time to reach you *</label>
                <select name="entry.667788990" class="form-select form-select-lg">
                  <option>Morning (9am–12noon)</option>
                  <option>Afternoon (12noon–5pm)</option>
                  <option>Evening (5pm–9pm)</option>
                  <option>Anytime</option>
                  <option>I need help right now. ASAP</option>
                </select>
              </div>

              <!-- Submit -->
              <div class="text-center">
                <button type="submit" class="btn text-white fw-bold px-5 py-3 rounded-pill shadow-lg"
                        style="background: linear-gradient(135deg, #a855f7, #d946ef); font-size: 1.3rem;">
                  I Need Help – Book My Session
                </button>
              </div>

              <p class="text-center text-muted mt-4 small">
                Your information is <strong>100% confidential</strong>. We will contact you within 24 hours.
              </p>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
  <script>
  // Redirect to mentorship.html after Google Form submission
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    
    form.addEventListener("submit", function (e) {
      // Show thank you message
      e.preventDefault(); // Stop normal submission temporarily
      
      // Optional: Show a nice thank you overlay
      const thankYou = `
        <div style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);color:white;display:flex;align-items:center;justify-content:center;z-index:9999;flex-direction:column;padding:2rem;text-align:center;">
          <i class="bi bi-heart-fill fs-1 text-accent mb-3" style="color:#ec4899;"></i>
          <h1 class="display-5 fw-bold">Thank You, Sister!</h1>
          <p class="lead">Your application has been submitted.<br>We’ll match you with your peer circle soon.</p>
          <p>Redirecting you back to Counseling...</p>
        </div>
      `;
      document.body.insertAdjacentHTML('beforeend', thankYou);

      // Submit the form for real
      setTimeout(() => {
        form.submit();
      }, 800);

      // Redirect after 3 seconds (Google Forms finishes submitting)
      setTimeout(() => {
        window.location.href= "{% url 'counseling' %}";
      }, 3000);
    });
  });
</script>
<script>
  // PERFECT redirect after Google Form submission
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");

    form.addEventListener("submit", function (e) {
      e.preventDefault(); // Stop normal submit

      // 1. Show beautiful thank you
      document.body.innerHTML = `
        <div style="min-height:100vh;background:linear-gradient(135deg,#fce7f3,#f0d6ff);display:flex;align-items:center;justify-content:center;flex-direction:column;gap:2rem;padding:2rem;text-align:center;">
          <i class="bi bi-heart-fill" style="font-size:4rem;color:#ec4899;"></i>
          <h1 class="display-4 fw-bold text-gradient" style="background:linear-gradient(90deg,#ec4899,#d946ef);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">
            Thank You, Sister!
          </h1>
          <p class="lead">Your application was submitted successfully.</p>
          <p>Redirecting you back to Counseling in <span id="countdown">3</span> seconds...</p>
        </div>
      `;

      // 2. Submit the real form (in background)
      const formData = new FormData(form);
      fetch(form.action, {
        method: "POST",
        body: formData,
        mode: "no-cors"  // Important for Google Forms
      });

      // 3. Countdown + redirect
      let seconds = 3;
      const countdown = setInterval(() => {
        seconds--;
        document.getElementById("countdown").textContent = seconds;
        if (seconds <= 0) {
          clearInterval(countdown);
          window.location.href = "{% url 'counseling' %}";  // This WILL work now
        }
      }, 1000);
    });
  });
</script>
{% endblock %}
</body>
</html>